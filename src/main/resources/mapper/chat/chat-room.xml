<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tinyhappytrip.chat.mapper.ChatRoomMapper">
    <select id="selectChatRoomIdBetweenUsers">
        SELECT chat_room_id
        FROM chat_rooms
        WHERE (participant_id1 = #{participantId1} AND participant_id2 = #{participantId2})
           OR (participant_id1 = #{participantId2} AND participant_id2 = #{participantId1})
    </select>

    <insert id="insert">
        INSERT INTO chat_rooms (participant_id1, participant_id2)
        VALUES (#{participantId1}, #{participantId2})
    </insert>

    <select id="selectAllChatRoomsByUserId">
        SELECT *
        FROM chat_rooms
        WHERE participant_id1 = #{userId}
           OR participant_id2 = #{userId}
    </select>

</mapper>